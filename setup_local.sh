#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π PostgreSQL

echo "üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Alien Tap Backend —Å –ª–æ–∫–∞–ª—å–Ω–æ–π PostgreSQL..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è .env
if [ ! -f .env ]; then
    echo "üìù –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞..."
    cp env.example .env
    echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL!"
    echo "   –¢–µ–∫—É—â–∏–π DATABASE_URL: postgres://anymacstore@localhost:5432/alien_game"
    echo ""
    read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è .env —Ñ–∞–π–ª–∞..."
fi

echo "‚úÖ .env —Ñ–∞–π–ª –≥–æ—Ç–æ–≤"
echo ""

# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ë–î
echo "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:"
echo ""
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ pgAdmin 4"
echo "2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É PostgreSQL 16"
echo "3. –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ 'Databases' -> 'Create' -> 'Database'"
echo "4. –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: alien_game"
echo "5. –ù–∞–∂–º–∏—Ç–µ 'Save'"
echo ""
echo "–ò–õ–ò –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª (–µ—Å–ª–∏ psql –¥–æ—Å—Ç—É–ø–µ–Ω):"
echo "   createdb -U anymacstore alien_game"
echo ""
echo "6. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ë–î, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ pgAdmin:"
echo "   - –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ –±–∞–∑—É 'alien_game' -> 'Query Tool'"
echo "   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞: migrations/20240101000001_create_tables.sql"
echo "   - –í—Å—Ç–∞–≤—å—Ç–µ –≤ Query Tool –∏ –Ω–∞–∂–º–∏—Ç–µ Execute (F5)"
echo ""

read -p "–°–æ–∑–¥–∞–ª–∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö alien_game? (y/n) " -n 1 -r
echo ""

if [[ $REPLY =~ ^[Yy]$ ]]; then
    echo "‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Å–±–æ—Ä–∫–µ –ø—Ä–æ–µ–∫—Ç–∞"
    echo ""
    echo "–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
    echo "1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π TELEGRAM_BOT_TOKEN"
    echo "2. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: cargo build --release"
    echo "3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: cargo run"
else
    echo "‚ö†Ô∏è  –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞"
fi

